<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title>19_functions_practice.knit</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="libs/reveal.js-3.3.0.1/css/reveal.css"/>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="libs/reveal.js-3.3.0.1/css/theme/white.css" id="theme">


  <!-- some tweaks to reveal css -->
  <style type="text/css">
    .reveal h1 { font-size: 2.0em; }
    .reveal h2 { font-size: 1.5em;  }
    .reveal h3 { font-size: 1.25em;	}
    .reveal h4 { font-size: 1em;	}

    .reveal .slides>section,
    .reveal .slides>section>section {
      padding: 0px 0px;
    }



    .reveal table {
      border-width: 1px;
      border-spacing: 2px;
      border-style: dotted;
      border-color: gray;
      border-collapse: collapse;
      font-size: 0.7em;
    }

    .reveal table th {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      font-weight: bold;
      border-style: dotted;
      border-color: gray;
    }

    .reveal table td {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      border-style: dotted;
      border-color: gray;
    }


  </style>

    <style type="text/css">code{white-space: pre;}</style>

    <link rel="stylesheet" href="style.css"/>

<!-- Printing and PDF exports -->
<script id="paper-css" type="application/dynamic-css">

/* Default Print Stylesheet Template
   by Rob Glazebrook of CSSnewbie.com
   Last Updated: June 4, 2008

   Feel free (nay, compelled) to edit, append, and
   manipulate this file as you see fit. */


@media print {

	/* SECTION 1: Set default width, margin, float, and
	   background. This prevents elements from extending
	   beyond the edge of the printed page, and prevents
	   unnecessary background images from printing */
	html {
		background: #fff;
		width: auto;
		height: auto;
		overflow: visible;
	}
	body {
		background: #fff;
		font-size: 20pt;
		width: auto;
		height: auto;
		border: 0;
		margin: 0 5%;
		padding: 0;
		overflow: visible;
		float: none !important;
	}

	/* SECTION 2: Remove any elements not needed in print.
	   This would include navigation, ads, sidebars, etc. */
	.nestedarrow,
	.controls,
	.fork-reveal,
	.share-reveal,
	.state-background,
	.reveal .progress,
	.reveal .backgrounds {
		display: none !important;
	}

	/* SECTION 3: Set body font face, size, and color.
	   Consider using a serif font for readability. */
	body, p, td, li, div {
		font-size: 20pt!important;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		color: #000;
	}

	/* SECTION 4: Set heading font face, sizes, and color.
	   Differentiate your headings from your body text.
	   Perhaps use a large sans-serif for distinction. */
	h1,h2,h3,h4,h5,h6 {
		color: #000!important;
		height: auto;
		line-height: normal;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		text-shadow: 0 0 0 #000 !important;
		text-align: left;
		letter-spacing: normal;
	}
	/* Need to reduce the size of the fonts for printing */
	h1 { font-size: 28pt !important;  }
	h2 { font-size: 24pt !important; }
	h3 { font-size: 22pt !important; }
	h4 { font-size: 22pt !important; font-variant: small-caps; }
	h5 { font-size: 21pt !important; }
	h6 { font-size: 20pt !important; font-style: italic; }

	/* SECTION 5: Make hyperlinks more usable.
	   Ensure links are underlined, and consider appending
	   the URL to the end of the link for usability. */
	a:link,
	a:visited {
		color: #000 !important;
		font-weight: bold;
		text-decoration: underline;
	}
	/*
	.reveal a:link:after,
	.reveal a:visited:after {
		content: " (" attr(href) ") ";
		color: #222 !important;
		font-size: 90%;
	}
	*/


	/* SECTION 6: more reveal.js specific additions by @skypanther */
	ul, ol, div, p {
		visibility: visible;
		position: static;
		width: auto;
		height: auto;
		display: block;
		overflow: visible;
		margin: 0;
		text-align: left !important;
	}
	.reveal pre,
	.reveal table {
		margin-left: 0;
		margin-right: 0;
	}
	.reveal pre code {
		padding: 20px;
		border: 1px solid #ddd;
	}
	.reveal blockquote {
		margin: 20px 0;
	}
	.reveal .slides {
		position: static !important;
		width: auto !important;
		height: auto !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 0 !important;
		zoom: 1 !important;

		overflow: visible !important;
		display: block !important;

		text-align: left !important;
		-webkit-perspective: none;
		   -moz-perspective: none;
		    -ms-perspective: none;
		        perspective: none;

		-webkit-perspective-origin: 50% 50%;
		   -moz-perspective-origin: 50% 50%;
		    -ms-perspective-origin: 50% 50%;
		        perspective-origin: 50% 50%;
	}
	.reveal .slides section {
		visibility: visible !important;
		position: static !important;
		width: auto !important;
		height: auto !important;
		display: block !important;
		overflow: visible !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 60px 20px !important;
		z-index: auto !important;

		opacity: 1 !important;

		page-break-after: always !important;

		-webkit-transform-style: flat !important;
		   -moz-transform-style: flat !important;
		    -ms-transform-style: flat !important;
		        transform-style: flat !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;

		-webkit-transition: none !important;
		   -moz-transition: none !important;
		    -ms-transition: none !important;
		        transition: none !important;
	}
	.reveal .slides section.stack {
		padding: 0 !important;
	}
	.reveal section:last-of-type {
		page-break-after: avoid !important;
	}
	.reveal section .fragment {
		opacity: 1 !important;
		visibility: visible !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;
	}
	.reveal section img {
		display: block;
		margin: 15px 0px;
		background: rgba(255,255,255,1);
		border: 1px solid #666;
		box-shadow: none;
	}

	.reveal section small {
		font-size: 0.8em;
	}

}  
</script>


<script id="pdf-css" type="application/dynamic-css">
    
/**
 * This stylesheet is used to print reveal.js
 * presentations to PDF.
 *
 * https://github.com/hakimel/reveal.js#pdf-export
 */

* {
	-webkit-print-color-adjust: exact;
}

body {
	margin: 0 auto !important;
	border: 0;
	padding: 0;
	float: none !important;
	overflow: visible;
}

html {
	width: 100%;
	height: 100%;
	overflow: visible;
}

/* Remove any elements not needed in print. */
.nestedarrow,
.reveal .controls,
.reveal .progress,
.reveal .playback,
.reveal.overview,
.fork-reveal,
.share-reveal,
.state-background {
	display: none !important;
}

h1, h2, h3, h4, h5, h6 {
	text-shadow: 0 0 0 #000 !important;
}

.reveal pre code {
	overflow: hidden !important;
	font-family: Courier, 'Courier New', monospace !important;
}

ul, ol, div, p {
	visibility: visible;
	position: static;
	width: auto;
	height: auto;
	display: block;
	overflow: visible;
	margin: auto;
}
.reveal {
	width: auto !important;
	height: auto !important;
	overflow: hidden !important;
}
.reveal .slides {
	position: static;
	width: 100%;
	height: auto;

	left: auto;
	top: auto;
	margin: 0 !important;
	padding: 0 !important;

	overflow: visible;
	display: block;

	-webkit-perspective: none;
	   -moz-perspective: none;
	    -ms-perspective: none;
	        perspective: none;

	-webkit-perspective-origin: 50% 50%; /* there isn't a none/auto value but 50-50 is the default */
	   -moz-perspective-origin: 50% 50%;
	    -ms-perspective-origin: 50% 50%;
	        perspective-origin: 50% 50%;
}

.reveal .slides section {
	page-break-after: always !important;

	visibility: visible !important;
	position: relative !important;
	display: block !important;
	position: relative !important;

	margin: 0 !important;
	padding: 0 !important;
	box-sizing: border-box !important;
	min-height: 1px;

	opacity: 1 !important;

	-webkit-transform-style: flat !important;
	   -moz-transform-style: flat !important;
	    -ms-transform-style: flat !important;
	        transform-style: flat !important;

	-webkit-transform: none !important;
	   -moz-transform: none !important;
	    -ms-transform: none !important;
	        transform: none !important;
}

.reveal section.stack {
	margin: 0 !important;
	padding: 0 !important;
	page-break-after: avoid !important;
	height: auto !important;
	min-height: auto !important;
}

.reveal img {
	box-shadow: none;
}

.reveal .roll {
	overflow: visible;
	line-height: 1em;
}

/* Slide backgrounds are placed inside of their slide when exporting to PDF */
.reveal section .slide-background {
	display: block !important;
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	z-index: -1;
}

/* All elements should be above the slide-background */
.reveal section>* {
	position: relative;
	z-index: 1;
}

/* Display slide speaker notes when 'showNotes' is enabled */
.reveal .speaker-notes-pdf {
	display: block;
	width: 100%;
	max-height: none;
	left: auto;
	top: auto;
	z-index: 100;
}

/* Display slide numbers when 'slideNumber' is enabled */
.reveal .slide-number-pdf {
	display: block;
	position: absolute;
	font-size: 14px;
}

</script>


<script>
var style = document.createElement( 'style' );
style.type = 'text/css';
var style_script_id = window.location.search.match( /print-pdf/gi ) ? 'pdf-css' : 'paper-css';
var style_script = document.getElementById(style_script_id).text;
style.innerHTML = style_script;
document.getElementsByTagName('head')[0].appendChild(style);
</script>

    <script src="libs/header-attrs-2.20/header-attrs.js"></script>
</head>
<body>
  <div class="reveal">
    <div class="slides">


<section id="section" class="slide level2">
<h2></h2>
<br>
<h2>
<center>
Writing Reusable Code with Functions
</center>
</h2>
<p><img data-src="Images/functions/function.png" /></p>
</section>
<section id="lets-say-you-have-this" class="slide level2">
<h2>Let’s Say You Have This…</h2>
<p><img data-src="Images/functions/buoyfiles.jpg" /></p>
</section>
<section id="you-want-to" class="slide level2">
<h2>You Want To…</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dat  <span class="ot">&lt;-</span> <span class="fu">make_buoy_data</span>(<span class="dv">1986</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Temperature_c)) <span class="sc">+</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="19_functions_practice_files/figure-revealjs/unnamed-chunk-1-1.jpeg" width="672" /></p>
</section>
<section id="but-there-are-problems---changing-year-formats-and-names"
class="slide level2">
<h2>But There Are Problems - Changing Year Formats and names</h2>
<pre><code># A tibble: 6 × 16
     YY    MM    DD    hh    WD  WSPD   GST  WVHT   DPD   APD   MWD   BAR  ATMP
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    86     1     1     0   210     9    11    99    99    99   999 1009.   5.8
2    86     1     1     1   210     9    10    99    99    99   999 1009.   4.7
3    86     1     1     2   220     8    10    99    99    99   999 1009.   4  
4    86     1     1     3   220     6     8    99    99    99   999 1009.   3.9
5    86     1     1     4   210     6     8    99    99    99   999 1009    3.9
6    86     1     1     5   210     6     8    99    99    99   999 1008.   3.9
# ℹ 3 more variables: WTMP &lt;dbl&gt;, DEWP &lt;dbl&gt;, VIS &lt;dbl&gt;</code></pre>
<pre><code># A tibble: 6 × 16
   YYYY    MM    DD    hh    WD  WSPD   GST  WVHT   DPD   APD   MWD   BAR  ATMP
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  1999     1     1     0   221   5.4   7.2  0.33  11.1  5.25   999 1017.  -4.3
2  1999     1     1     1   218   5.6   7.3  0.31  11.1  5.51   999 1016.  -4  
3  1999     1     1     2   226   5.7   7    0.32  12.5  6.53   999 1016.  -3.9
4  1999     1     1     3   228   5.7   7.3  0.31  11.1  6.17   999 1015.  -3.9
5  1999     1     1     4   237   5.9   7.7  0.39  11.1  5.02   999 1015   -3.8
6  1999     1     1     5   235   5.7   7.5  0.42  11.1  4.81   999 1015.  -3.9
# ℹ 3 more variables: WTMP &lt;dbl&gt;, DEWP &lt;dbl&gt;, VIS &lt;dbl&gt;</code></pre>
</section>
<section id="worse-nonnumeric-row-cruft" class="slide level2">
<h2>Worse… nonnumeric row cruft</h2>
<pre><code># A tibble: 6 × 18
  X.YY  MM    DD    hh    mm    WDIR  WSPD  GST   WVHT  DPD   APD   MWD   PRES  
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; 
1 #yr   mo    dy    hr    mn    degT  m/s   m/s   m     sec   sec   degT  hPa   
2 2012  06    30    23    50    253   3.4   4.2   0.52  9.09  5.33  86    1005.4
3 2012  07    01    00    50    198   3.5   4.1   0.53  7.69  5.41  107   1005.7
4 2012  07    01    01    50    199   4.0   4.7   0.48  10.00 5.60  102   1006.1
5 2012  07    01    02    50    218   3.9   4.4   0.45  9.09  5.20  87    1006.1
6 2012  07    01    03    50    222   4.5   4.8   0.41  7.69  4.68  100   1006.5
# ℹ 5 more variables: ATMP &lt;chr&gt;, WTMP &lt;chr&gt;, DEWP &lt;chr&gt;, VIS &lt;chr&gt;, TIDE &lt;chr&gt;</code></pre>
</section>
<section id="section-1" class="slide level2">
<h2></h2>
<br><br><br>
<h2>
Solutions?
</h2>
</section>
<section id="solutions" class="slide level2">
<h2>Solutions</h2>
<ol type="1">
<li>Write code for each individual file
<ul>
<li>Lots of copy-paste</li>
</ul></li>
<li>Write code that row-binds all data and clean from there
<ul>
<li>Only good once - what about next year?</li>
</ul></li>
<li>FUNCTIONS!</li>
</ol>
</section>
<section id="what-is-our-philosophy" class="slide level2">
<h2>What is our Philosophy?</h2>
<p align="left">
<br><br> “You should consider writing a function whenever you’ve copied
and pasted a block of code more than twice” <Br> <br>- H. Wickham
</p>
</section>
<section id="lets-find-the-problems" class="slide level2">
<h2>Let’s Find the Problems!</h2>
<center>
Work with a partner, load in data files individually, and identify all
of the problems/things that are different from file to file. Or, things
that might make it difficult to work with data later (i.e., hard to
understand what is in the data).
</center>
</section>
<section id="problems-with-buoys---each-one-or-two-is-a-function"
class="slide level2">
<h2>Problems with Buoys - Each one (or two) is a function!</h2>
<ol type="1">
<li><p>NA characters vary (99, 999).</p></li>
<li><p>Need to eliminate rows with <code>#yr</code> &amp; turn cols
numeric</p></li>
<li><p>Names for year are nonstandard</p>
<ul>
<li>X.YY, YY, and YYYY</li>
</ul></li>
<li><p>Some years are listed with only two digits</p>
<ul>
<li>Typically, but maybe not always, less than 1999</li>
</ul></li>
<li><p>Col names are abbreviations - make it readable!</p></li>
<li><p>Is hourly really a good idea?</p></li>
</ol>
</section>
<section id="where-to-start" class="slide level2">
<h2>Where to Start?!</h2>
<ul>
<li><p>Every problem is an opportunity for a function.</p></li>
<li><p>With every problem, identify what you want to input as an
argument, and what you want as an output.</p></li>
<li><p>Don’t make one function do too much! You can always chain
together many functions</p></li>
</ul>
</section>
<section id="to-start---reading-in-a-buoy-file" class="slide level2">
<h2>To start - reading in a buoy file</h2>
<ul>
<li><p>Let’s just write a function that will read in any of the buoys
and return a nice data frame.</p></li>
<li><p>Let’s call it <code>read_buoy</code>.</p></li>
<li><p>But before we start….</p></li>
</ul>
</section>
<section id="how-do-i-build-a-function" class="slide level2">
<h2>How do I build a function?</h2>
<ol type="1">
<li>OK, what’s <em>normally</em> going to change
<ul>
<li>The year!</li>
</ul></li>
<li>BUT - what could change under some circumstances?
<ul>
<li>buoy number, directory, separator.</li>
<li>let’s leave that for later and just</li>
</ul></li>
<li>Identify what could differ between files for <strong>just
loading</strong>
<ul>
<li>Don’t try and do too much at once!</li>
</ul></li>
<li>Write some test code to load in one buoy NOT in a function to
start</li>
</ol>
</section>
<section id="test-code-copy-these-comments-and-write-code"
class="slide level2">
<h2>Test Code: Copy these comments and write code!</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a year</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># make a filename</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># read in a file</span></span></code></pre></div>
</section>
<section id="test-code-example" class="slide level2">
<h2>Test Code Example</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a year</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>a_year <span class="ot">&lt;-</span> <span class="dv">2013</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make a filename (could use paste0 instead of str_c)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># or glue::glue()</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>buoy_file <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">&quot;lectures/data/buoydata/44013_&quot;</span>, a_year, <span class="st">&quot;.csv&quot;</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># read in a file</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(buoy_file)</span></code></pre></div>
<pre><code># A tibble: 8,210 × 18
   X.YY  MM    DD    hh    mm    WDIR  WSPD  GST   WVHT  DPD   APD   MWD   PRES 
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 #yr   mo    dy    hr    mn    degT  m/s   m/s   m     sec   sec   degT  hPa  
 2 2012  12    31    23    50    234   8.5   10.2  0.42  3.33  3.14  279   1011…
 3 2013  01    01    00    50    246   9.0   10.9  0.52  2.86  2.94  251   1010…
 4 2013  01    01    01    50    243   7.3   9.4   0.50  3.33  3.05  237   1010…
 5 2013  01    01    02    50    252   10.5  12.4  0.50  3.03  2.99  244   1009…
 6 2013  01    01    03    50    256   10.9  13.0  0.65  3.70  3.28  265   1008…
 7 2013  01    01    04    50    254   11.6  13.2  0.72  3.70  3.33  255   1007…
 8 2013  01    01    05    50    244   10.8  12.7  0.84  4.00  3.54  260   1006…
 9 2013  01    01    06    50    241   10.5  12.4  0.74  3.85  3.34  259   1006…
10 2013  01    01    07    50    237   9.7   11.9  0.67  3.70  3.17  257   1006…
# ℹ 8,200 more rows
# ℹ 5 more variables: ATMP &lt;chr&gt;, WTMP &lt;chr&gt;, DEWP &lt;chr&gt;, VIS &lt;chr&gt;, TIDE &lt;chr&gt;</code></pre>
</section>
<section id="unit-testing" class="slide level2">
<h2>Unit Testing</h2>
<p>Take the smallest piece of code in an application, and make a test to
ensure if works properly</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define a year</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>a_year <span class="ot">&lt;-</span> <span class="dv">1993</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#make a filename</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>buoy_file <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">&quot;lectures/data/buoydata/44013_&quot;</span>, a_year, <span class="st">&quot;.csv&quot;</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># read in a file</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(buoy_file)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># A </span><span class="al">TEST</span><span class="co"> (or two)</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>visdat<span class="sc">::</span><span class="fu">vis_dat</span>(dat)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code></pre></div>
</section>
<section id="unit-test-for-1993---ok-on-type" class="slide level2">
<h2>Unit test for 1993 - OK on type</h2>
<p><img src="19_functions_practice_files/figure-revealjs/unnamed-chunk-2-1.jpeg" width="672" /></p>
</section>
<section id="unit-test-for-1993---bad-on-range" class="slide level2">
<h2>Unit test for 1993 - bad on range!</h2>
<pre><code>       YY           MM               DD              hh             WD       
 Min.   :93   Min.   : 1.000   Min.   : 1.00   Min.   : 0.0   Min.   :  0.0  
 1st Qu.:93   1st Qu.: 4.000   1st Qu.: 8.00   1st Qu.: 5.0   1st Qu.:124.0  
 Median :93   Median : 7.000   Median :16.00   Median :11.0   Median :209.0  
 Mean   :93   Mean   : 6.538   Mean   :15.72   Mean   :11.5   Mean   :195.3  
 3rd Qu.:93   3rd Qu.:10.000   3rd Qu.:23.00   3rd Qu.:18.0   3rd Qu.:278.0  
 Max.   :93   Max.   :12.000   Max.   :31.00   Max.   :23.0   Max.   :999.0  
      WSPD             GST              WVHT             DPD        
 Min.   : 0.000   Min.   : 0.000   Min.   : 0.000   Min.   : 0.000  
 1st Qu.: 4.000   1st Qu.: 4.700   1st Qu.: 0.400   1st Qu.: 5.900  
 Median : 5.900   Median : 7.000   Median : 0.600   Median : 8.300  
 Mean   : 6.382   Mean   : 8.138   Mean   : 2.247   Mean   : 9.351  
 3rd Qu.: 8.200   3rd Qu.:10.000   3rd Qu.: 1.000   3rd Qu.:10.000  
 Max.   :99.000   Max.   :99.000   Max.   :99.000   Max.   :99.000  
      APD              MWD           BAR              ATMP       
 Min.   : 0.000   Min.   :  0   Min.   : 964.6   Min.   :-14.00  
 1st Qu.: 4.500   1st Qu.:999   1st Qu.:1010.7   1st Qu.:  2.80  
 Median : 5.600   Median :999   Median :1016.4   Median :  9.50  
 Mean   : 7.042   Mean   :792   Mean   :1035.0   Mean   : 10.58  
 3rd Qu.: 6.800   3rd Qu.:999   3rd Qu.:1022.5   3rd Qu.: 16.50  
 Max.   :99.000   Max.   :999   Max.   :9999.0   Max.   :999.00  
      WTMP             DEWP          VIS       
 Min.   :  0.80   Min.   :999   Min.   : 0.00  
 1st Qu.:  4.00   1st Qu.:999   1st Qu.:99.00  
 Median :  9.50   Median :999   Median :99.00  
 Mean   : 11.67   Mean   :999   Mean   :78.51  
 3rd Qu.: 14.10   3rd Qu.:999   3rd Qu.:99.00  
 Max.   :999.00   Max.   :999   Max.   :99.00  </code></pre>
<div class="fragment">
What are other problems these unit tests find? Try it out!
</div>
</section>
<section id="more-testing-with-small-changes---yes"
class="slide level2">
<h2>More testing with Small Changes - YES!</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(buoy_file, <span class="at">na =</span> <span class="fu">c</span>(<span class="st">&quot;99&quot;</span>, <span class="st">&quot;999&quot;</span>, <span class="st">&quot;9999&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>       YY           MM               DD              hh             WD       
 Min.   :93   Min.   : 1.000   Min.   : 1.00   Min.   : 0.0   Min.   :  0.0  
 1st Qu.:93   1st Qu.: 4.000   1st Qu.: 8.00   1st Qu.: 5.0   1st Qu.:124.0  
 Median :93   Median : 7.000   Median :16.00   Median :11.0   Median :209.0  
 Mean   :93   Mean   : 6.538   Mean   :15.72   Mean   :11.5   Mean   :195.1  
 3rd Qu.:93   3rd Qu.:10.000   3rd Qu.:23.00   3rd Qu.:18.0   3rd Qu.:278.0  
 Max.   :93   Max.   :12.000   Max.   :31.00   Max.   :23.0   Max.   :360.0  
                                                              NA&#39;s   :20     
      WSPD            GST              WVHT             DPD        
 Min.   : 0.00   Min.   : 0.000   Min.   :0.0000   Min.   : 0.000  
 1st Qu.: 4.00   1st Qu.: 4.700   1st Qu.:0.4000   1st Qu.: 5.900  
 Median : 5.90   Median : 7.000   Median :0.6000   Median : 8.300  
 Mean   : 6.34   Mean   : 7.739   Mean   :0.8358   Mean   : 8.043  
 3rd Qu.: 8.20   3rd Qu.: 9.900   3rd Qu.:1.0000   3rd Qu.:10.000  
 Max.   :25.70   Max.   :32.400   Max.   :6.1000   Max.   :16.700  
 NA&#39;s   :4       NA&#39;s   :38       NA&#39;s   :125      NA&#39;s   :125     
      APD            MWD             BAR              ATMP        
 Min.   : 0.0   Min.   :  0.0   Min.   : 964.6   Min.   :-14.000  
 1st Qu.: 4.5   1st Qu.: 73.0   1st Qu.:1010.6   1st Qu.:  2.800  
 Median : 5.6   Median : 91.0   Median :1016.4   Median :  9.500  
 Mean   : 5.7   Mean   :117.6   Mean   :1016.4   Mean   :  9.211  
 3rd Qu.: 6.7   3rd Qu.:111.0   3rd Qu.:1022.4   3rd Qu.: 16.500  
 Max.   :11.8   Max.   :358.0   Max.   :1044.5   Max.   : 31.900  
 NA&#39;s   :125    NA&#39;s   :6677    NA&#39;s   :20       NA&#39;s   :12       
      WTMP          DEWP              VIS       
 Min.   : 0.800   Mode:logical   Min.   : 0.00  
 1st Qu.: 4.000   NA&#39;s:8693      1st Qu.: 7.30  
 Median : 9.400                  Median : 9.10  
 Mean   : 9.503                  Mean   :11.74  
 3rd Qu.:14.100                  3rd Qu.:11.00  
 Max.   :22.000                  Max.   :35.80  
 NA&#39;s   :19                      NA&#39;s   :6652   </code></pre>
<div class="fragment">
Tested against a few years to figure out NAs, vis_dat helped
</div>
<Br>
<div class="fragment">
Now ask, what more can be generalized for arguments?
</div>
</section>
<section
id="make-this-a-function-by-making-a_year-an-argument-and-adding-a-return"
class="slide level2">
<h2>Make this a Function by making a_year an argument and adding a
return!</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define a year</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>a_year <span class="ot">&lt;-</span> <span class="dv">2013</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#make a filename</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>buoy_file <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">&quot;lectures/data/buoydata/44013_&quot;</span>, a_year, <span class="st">&quot;.csv&quot;</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># read in a file</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(buoy_file, <span class="at">na =</span> <span class="fu">c</span>(<span class="st">&quot;99&quot;</span>, <span class="st">&quot;999&quot;</span>, <span class="st">&quot;9999&quot;</span>))</span></code></pre></div>
<p>Also, get a little fancier and add a <code>buoy_number</code> and
<code>buoy_dir</code> argument with sensible defaults - you’ve got
this!</p>
</section>
<section id="one-reading-function" class="slide level2">
<h2>One Reading Function</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>read_buoy <span class="ot">&lt;-</span> <span class="cf">function</span>(a_year, <span class="at">buoy_number =</span> <span class="dv">44013</span>, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">buoy_dir =</span> <span class="st">&quot;lectures/data/buoydata/&quot;</span>){</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#make a file name</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  buoy_file <span class="ot">&lt;-</span> <span class="fu">str_c</span>(buoy_dir, buoy_number, <span class="st">&quot;_&quot;</span>, a_year, <span class="st">&quot;.csv&quot;</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#read in the file</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  one_buoy <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(buoy_file, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">na =</span> <span class="fu">c</span>(<span class="st">&quot;99&quot;</span>, <span class="st">&quot;999&quot;</span>, <span class="st">&quot;9999&quot;</span>))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return the file</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(one_buoy)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</section>
<section id="problems-with-buoys---each-one-or-two-is-a-function-1"
class="slide level2">
<h2>Problems with Buoys - Each one (or two) is a function!</h2>
<ol type="1">
<li><p><s>NA characters vary (99, 999).</s></p></li>
<li><p>Need to eliminate rows with <code>#yr</code> &amp; turn cols
numeric</p></li>
<li><p>Names for year are nonstandard</p>
<ul>
<li>X.YY, YY, and YYYY</li>
</ul></li>
<li><p>Some years are listed with only two digits</p>
<ul>
<li>Typically, but maybe not always, less than 1999</li>
</ul></li>
<li><p>Col names are abbreviations - make it readable!</p></li>
<li><p>Is hourly really a good idea?</p></li>
</ol>
</section>
<section id="problem-2-extra-rows-and-characters" class="slide level2">
<h2>Problem 2: Extra Rows and Characters</h2>
<pre><code># A tibble: 6 × 18
  X.YY  MM    DD    hh    mm    WDIR  WSPD  GST   WVHT  DPD   APD   MWD   PRES  
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; 
1 #yr   mo    dy    hr    mn    degT  m/s   m/s   m     sec   sec   degT  hPa   
2 2012  12    31    23    50    234   8.5   10.2  0.42  3.33  3.14  279   1011.6
3 2013  01    01    00    50    246   9.0   10.9  0.52  2.86  2.94  251   1010.8
4 2013  01    01    01    50    243   7.3   9.4   0.50  3.33  3.05  237   1010.0
5 2013  01    01    02    50    252   10.5  12.4  0.50  3.03  2.99  244   1009.0
6 2013  01    01    03    50    256   10.9  13.0  0.65  3.70  3.28  265   1008.1
# ℹ 5 more variables: ATMP &lt;chr&gt;, WTMP &lt;chr&gt;, DEWP &lt;chr&gt;, VIS &lt;chr&gt;, TIDE &lt;chr&gt;</code></pre>
</section>
<section id="fix-it-with-a-function" class="slide level2">
<h2>Fix it with a function!</h2>
<ul>
<li><p>Work with a partner and write a function that will strip
non-numeric rows from a buoy data frame and turn character cols
numeric</p></li>
<li><p>Start with a single test case, and apply unit tests.</p>
<ul>
<li>hint:
<code>mutate(across(.cols = everything(), .fns = as.numeric))</code><br />
</li>
<li>hint: what is the same and what is different across files?</li>
</ul></li>
<li><p>Once it works broadly, turn it into a function so that we
can…</p></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_buoy</span>(<span class="dv">1995</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fix_bad_buoy_rows</span>()</span></code></pre></div>
</section>
<section id="my-test-code-outline-there-are-many-solutions"
class="slide level2">
<h2>My test code outline (there are many solutions)</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get some buoy data</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn everything numeric, as then some rows will be all NA</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows where month is NA, as the year col name changes</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># TESTS</span></span></code></pre></div>
</section>
<section id="alternate-solution-if-we-dont-care-about-nas"
class="slide level2">
<h2>Alternate Solution if we Don’t Care About NAs</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get some buoy data</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn everything numeric, as then some rows will be all NA</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># TESTS</span></span></code></pre></div>
</section>
<section id="my-test-code" class="slide level2">
<h2>My test code</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get some buoy data</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_buoy</span>(<span class="dv">2013</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn everything numeric, as then some rows will be all NA</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">.fns =</span> as.numeric))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows where month is NA, as the year col name changes</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(MM))</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># TESTS</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>visdat<span class="sc">::</span><span class="fu">vis_dat</span>(dat)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code></pre></div>
</section>
<section id="turn-it-into-a-function" class="slide level2">
<h2>Turn it into a function</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fix_bad_buoy_rows <span class="ot">&lt;-</span> <span class="cf">function</span>(dat) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Turn everything numeric, as then some rows will be all NA</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">.fns =</span> as.numeric)) <span class="sc">|&gt;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove rows where month is NA, as the year col name changes</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(MM))</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dat)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</section>
<section id="does-it-blend" class="slide level2">
<h2>Does It Blend?</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_buoy</span>(<span class="dv">2013</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fix_bad_buoy_rows</span>() <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 × 18
   X.YY    MM    DD    hh    mm  WDIR  WSPD   GST  WVHT   DPD   APD   MWD  PRES
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  2012    12    31    23    50   234   8.5  10.2  0.42  3.33  3.14   279 1012.
2  2013     1     1     0    50   246   9    10.9  0.52  2.86  2.94   251 1011.
3  2013     1     1     1    50   243   7.3   9.4  0.5   3.33  3.05   237 1010 
4  2013     1     1     2    50   252  10.5  12.4  0.5   3.03  2.99   244 1009 
5  2013     1     1     3    50   256  10.9  13    0.65  3.7   3.28   265 1008.
6  2013     1     1     4    50   254  11.6  13.2  0.72  3.7   3.33   255 1007.
# ℹ 5 more variables: ATMP &lt;dbl&gt;, WTMP &lt;dbl&gt;, DEWP &lt;dbl&gt;, VIS &lt;dbl&gt;, TIDE &lt;dbl&gt;</code></pre>
</section>
<section id="problems-with-buoys---each-one-or-two-is-a-function-2"
class="slide level2">
<h2>Problems with Buoys - Each one (or two) is a function!</h2>
<ol type="1">
<li><p><s>NA characters vary (99, 999).</s></p></li>
<li><p><s>Need to eliminate rows with <code>#yr</code> &amp; turn cols
numeric</s></p></li>
<li><p>Names for year are nonstandard</p>
<ul>
<li>X.YY, YY, and YYYY</li>
</ul></li>
<li><p>Some years are listed with only two digits</p>
<ul>
<li>Typically, but maybe not always, less than 1999</li>
</ul></li>
<li><p>Col names are abbreviations - make it readable!</p></li>
<li><p>Is hourly really a good idea?</p></li>
</ol>
</section>
<section id="that-year-problem" class="slide level2">
<h2>That Year Problem</h2>
<pre><code># A tibble: 6 × 16
     YY    MM    DD    hh    WD  WSPD   GST  WVHT   DPD   APD   MWD   BAR  ATMP
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    86     1     1     0   210     9    11    NA    NA    NA    NA 1009.   5.8
2    86     1     1     1   210     9    10    NA    NA    NA    NA 1009.   4.7
3    86     1     1     2   220     8    10    NA    NA    NA    NA 1009.   4  
4    86     1     1     3   220     6     8    NA    NA    NA    NA 1009.   3.9
5    86     1     1     4   210     6     8    NA    NA    NA    NA 1009    3.9
6    86     1     1     5   210     6     8    NA    NA    NA    NA 1008.   3.9
# ℹ 3 more variables: WTMP &lt;dbl&gt;, DEWP &lt;dbl&gt;, VIS &lt;dbl&gt;</code></pre>
<pre><code># A tibble: 6 × 16
   YYYY    MM    DD    hh    WD  WSPD   GST  WVHT   DPD   APD   MWD   BAR  ATMP
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  1999     1     1     0   221   5.4   7.2  0.33  11.1  5.25    NA 1017.  -4.3
2  1999     1     1     1   218   5.6   7.3  0.31  11.1  5.51    NA 1016.  -4  
3  1999     1     1     2   226   5.7   7    0.32  12.5  6.53    NA 1016.  -3.9
4  1999     1     1     3   228   5.7   7.3  0.31  11.1  6.17    NA 1015.  -3.9
5  1999     1     1     4   237   5.9   7.7  0.39  11.1  5.02    NA 1015   -3.8
6  1999     1     1     5   235   5.7   7.5  0.42  11.1  4.81    NA 1015.  -3.9
# ℹ 3 more variables: WTMP &lt;dbl&gt;, DEWP &lt;dbl&gt;, VIS &lt;dbl&gt;</code></pre>
</section>
<section id="that-year-problem-1" class="slide level2">
<h2>That Year Problem</h2>
<pre><code># A tibble: 6 × 16
     YY    MM    DD    hh    WD  WSPD   GST  WVHT   DPD   APD   MWD   BAR  ATMP
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    86     1     1     0   210     9    11    NA    NA    NA    NA 1009.   5.8
2    86     1     1     1   210     9    10    NA    NA    NA    NA 1009.   4.7
3    86     1     1     2   220     8    10    NA    NA    NA    NA 1009.   4  
4    86     1     1     3   220     6     8    NA    NA    NA    NA 1009.   3.9
5    86     1     1     4   210     6     8    NA    NA    NA    NA 1009    3.9
6    86     1     1     5   210     6     8    NA    NA    NA    NA 1008.   3.9
# ℹ 3 more variables: WTMP &lt;dbl&gt;, DEWP &lt;dbl&gt;, VIS &lt;dbl&gt;</code></pre>
<pre><code># A tibble: 6 × 18
   X.YY    MM    DD    hh    mm  WDIR  WSPD   GST  WVHT   DPD   APD   MWD  PRES
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  2012     6    30    23    50   253   3.4   4.2  0.52  9.09  5.33    86 1005.
2  2012     7     1     0    50   198   3.5   4.1  0.53  7.69  5.41   107 1006.
3  2012     7     1     1    50   199   4     4.7  0.48 10     5.6    102 1006.
4  2012     7     1     2    50   218   3.9   4.4  0.45  9.09  5.2     87 1006.
5  2012     7     1     3    50   222   4.5   4.8  0.41  7.69  4.68   100 1006.
6  2012     7     1     4    50   231   3.4   3.8  0.4   9.09  5.24    82 1006.
# ℹ 5 more variables: ATMP &lt;dbl&gt;, WTMP &lt;dbl&gt;, DEWP &lt;dbl&gt;, VIS &lt;dbl&gt;, TIDE &lt;dbl&gt;</code></pre>
</section>
<section id="fix-two-problems-with-1-function" class="slide level2">
<h2>Fix two problems with 1 function!</h2>
<ul>
<li><p>Work with a partner and write a function that will:<br />
- make the year column always be YYYY<br />
- make the year column be a 4 digit year (e.g. 98 = 1998)<br />
- hint: this is a good order to solve in<br />
- hint: regexp with <code>names()</code> or <code>rename_with()</code>
are helpful</p></li>
<li><p>Test &amp; once it works broadly, turn it into a function so that
we can…</p></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_buoy</span>(<span class="dv">1995</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fix_bad_buoy_rows</span>() <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">standardize_buoy_years</span>()</span></code></pre></div>
</section>
<section id="my-test-code-1" class="slide level2">
<h2>My test code</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get buoy data</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_buoy</span>(<span class="dv">1986</span>)<span class="sc">|&gt;</span> <span class="fu">fix_bad_buoy_rows</span>()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use rename_with to fix year column name</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> <span class="fu">rename_with</span>(</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">.cols =</span> <span class="fu">contains</span>(<span class="st">&quot;YY&quot;</span>),</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">.fn =</span> <span class="sc">~</span><span class="st">&quot;YYYY&quot;</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co"># if a year is &lt; 100, add 1900 to it</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YYYY =</span> <span class="fu">ifelse</span>(YYYY <span class="sc">&lt;</span> <span class="dv">100</span>, YYYY<span class="sc">+</span><span class="dv">1900</span>, YYYY))</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TEST</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(dat<span class="sc">$</span>YYYY)</span></code></pre></div>
</section>
<section id="my-alternate-code" class="slide level2">
<h2>My alternate code</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get buoy data</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_buoy</span>(<span class="dv">1986</span>)<span class="sc">|&gt;</span> <span class="fu">fix_bad_buoy_rows</span>()</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use regexp to fix year column name</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dat) <span class="ot">&lt;-</span> <span class="fu">str_replace</span>( <span class="fu">names</span>(dat),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pattern =</span> <span class="st">&quot;X</span><span class="sc">\\</span><span class="st">.YY&quot;</span>, </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">replace =</span> <span class="st">&quot;YYYY&quot;</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dat) <span class="ot">&lt;-</span> <span class="fu">str_replace</span>( <span class="fu">names</span>(dat),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pattern =</span> <span class="st">&quot;^YY$&quot;</span>, </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">replace =</span> <span class="st">&quot;YYYY&quot;</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co"># if a year is &lt; 100, add 1900 to it</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">YYYY =</span> <span class="fu">ifelse</span>(YYYY <span class="sc">&lt;</span> <span class="dv">100</span>, YYYY<span class="sc">+</span><span class="dv">1900</span>, YYYY))</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TEST</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(dat<span class="sc">$</span>YYYY)</span></code></pre></div>
</section>
<section id="make-it-into-a-function" class="slide level2">
<h2>Make it into a function</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>standardize_buoy_years <span class="ot">&lt;-</span> <span class="cf">function</span>(dat) {</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use rename_with to fix year column name</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> <span class="fu">rename_with</span>(<span class="at">.cols =</span> <span class="fu">contains</span>(<span class="st">&quot;YY&quot;</span>),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.fn =</span> <span class="sc">~</span> <span class="st">&quot;YYYY&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if a year is &lt; 100, add 1900 to it</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">YYYY =</span> <span class="fu">ifelse</span>(YYYY <span class="sc">&lt;</span> <span class="dv">100</span>, YYYY <span class="sc">+</span> <span class="dv">1900</span>, YYYY))</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dat)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</section>
<section id="does-it-blend-1" class="slide level2">
<h2>Does It Blend?</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_buoy</span>(<span class="dv">1995</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fix_bad_buoy_rows</span>() <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">standardize_buoy_years</span>() <span class="sc">|&gt;</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
</section>
<section id="does-it-blend-2" class="slide level2">
<h2>Does It Blend?</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_buoy</span>(<span class="dv">2013</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fix_bad_buoy_rows</span>() <span class="sc">|&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">standardize_buoy_years</span>() <span class="sc">|&gt;</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
</section>
<section id="problems-with-buoys---each-one-or-two-is-a-function-3"
class="slide level2">
<h2>Problems with Buoys - Each one (or two) is a function!</h2>
<ol type="1">
<li><p><s>NA characters vary (99, 999).</s></p></li>
<li><p><s>Need to eliminate rows with <code>#yr</code> &amp; turn cols
numeric</s></p></li>
<li><p><s>Names for year are nonstandard</s></p>
<ul>
<li><s>X.YY, YY, and YYYY</s></li>
</ul></li>
<li><p><s>Some years are listed with only two digits</s></p>
<ul>
<li><s>Typically, but maybe not always, less than 1999</s></li>
</ul></li>
<li><p>Col names are abbreviations - make it readable!</p></li>
<li><p>Is hourly really a good idea?</p></li>
</ol>
</section>
<section id="before-we-move-forward" class="slide level2">
<h2>Before We Move Forward…</h2>
<p>What is this?</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_buoy</span>(<span class="dv">1995</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fix_bad_buoy_rows</span>() <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">standardize_buoy_years</span>() </span></code></pre></div>
<div class="fragment">
Note that you have been making little function <strong>MODULES</strong>
that we string together
</div>
<div class="fragment">
<p>Year can still change - it’s almost like we have another function in
the making composed of modules…. this is….</p>
</div>
</section>
<section id="modular-programming" class="slide level2">
<h2>Modular Programming</h2>
<p><img data-src="Images/functions/functions_meme.jpg" /></p>
</section>
<section id="wait-what-is-this-modular-madness" class="slide level2">
<h2>Wait, what is this modular madness?</h2>
<ul>
<li><p>Our code is composed of modular pieces</p></li>
<li><p>This means each modular function can be used in other
contexts</p>
<ul>
<li>Enhances code flexibility and future reuse</li>
</ul></li>
<li><p>It also means it is easier to find where our code has gone
wrong</p>
<ul>
<li>Easier to test and debug</li>
</ul></li>
<li><p>AND - we don’t get lost writing one honking single
function</p></li>
</ul>
</section>
<section id="from-pipelines-to-wrapper-function" class="slide level2">
<h2>From Pipelines to Wrapper Function</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_buoy</span>(<span class="dv">1995</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fix_bad_buoy_rows</span>() <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">standardize_buoy_years</span>() </span></code></pre></div>
<div class="fragment">
Let’s wrap this in a function
</div>
<div class="fragment">
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>get_buoy_data <span class="ot">&lt;-</span> <span class="cf">function</span>(a_year){</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_buoy</span>(a_year) <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fix_bad_buoy_rows</span>() <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">standardize_buoy_years</span>() </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</section>
<section id="a-cleaner-wrapper" class="slide level2">
<h2>A Cleaner Wrapper</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>get_buoy_data <span class="ot">&lt;-</span> <span class="cf">function</span>(a_year){</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># read in buoy file and fix NAs</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_buoy</span>(a_year) <span class="sc">|&gt;</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fix non-numeric row problem</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fix_bad_buoy_rows</span>() <span class="sc">|&gt;</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># standardize year column</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">standardize_buoy_years</span>() </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</section>
<section id="backwards-approach-to-writing-modular-code"
class="slide level2">
<h2>Backwards Approach to Writing Modular Code</h2>
<ol type="1">
<li><p>Analyze the steps of your task.</p></li>
<li><p>Break it down into pieces.</p></li>
<li><p>Write one function per piece.</p></li>
<li><p>Chain pieces together in a pipeline.</p></li>
<li><p>Turn pipeline into a wrapper function!</p></li>
</ol>
</section>
<section id="or---thinking-forwards-for-writing-modular-code"
class="slide level2">
<h2>Or - Thinking Forwards for Writing Modular Code</h2>
<ol type="1">
<li><p>Start with a wrapper</p>
<ul>
<li>Write out the steps of what you want to do in comments<br />
</li>
<li>Pair those with functions using “snake case”
<code>clean_data</code><br />
</li>
<li>Use <code>|&gt;</code> for efficiency/readability!</li>
</ul></li>
<li><p>Write the subfunctions</p>
<ul>
<li>Repeat the toplevel comments anf functions</li>
</ul></li>
<li><p>Continue until you have the lowest level atomized
functions</p></li>
<li><p>Test THOSE functions. Then test up the chain….</p></li>
</ol>
</section>
<section id="why-do-this" class="slide level2">
<h2>Why do this</h2>
<ul>
<li><p>Reusable modules in other context.</p></li>
<li><p>Can unit test elements of the wrapper function</p></li>
<li><p>Easier to debug!</p></li>
<li><p>Can solve problems forwards or backwards!</p></li>
</ul>
</section>
<section id="reality-check" class="slide level2">
<h2>Reality Check</h2>
<p><br><br><br> Yes, sometimes you will write long functions - as long
as they are simple and readable, meh</p>
</section>
<section
id="final-exercises---do-1-and-then-make-wrappers-in-2-and-3-with-minimal-effort"
class="slide level2">
<h2>Final Exercises - do 1, and then make wrappers in 2 and 3 with
MINIMAL effort</h2>
<ol type="1">
<li><p>Write a function that will get daily summaries of wave height and
temperature only</p>
<ul>
<li>Make the returned column names for all values nice and
readable<br />
</li>
<li>use <code>paste()</code> and <code>as.Date()</code> to make a Date
column after summarize</li>
</ul></li>
<li><p>Do the same, but monthly…</p></li>
<li><p>Do the same, but anually….</p></li>
</ol>
</section>
    </div>
  </div>

  <script src="libs/reveal.js-3.3.0.1/lib/js/head.min.js"></script>
  <script src="libs/reveal.js-3.3.0.1/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,
        // Display a presentation progress bar
        progress: true,
        // Display the page number of the current slide
        slideNumber: true,
        // Push each slide change to the browser history
        history: true,
        // Enable keyboard shortcuts for navigation
        keyboard: true,
        // Enable the slide overview mode
        overview: true,
        // Vertical centering of slides
        center: false,
        // Enables touch navigation on devices with touch input
        touch: true,
        // Turns fragments on and off globally
        fragments: true,
        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,
        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,
        // Stop auto-sliding after user input
        autoSlideStoppable: true,
        // Opens links in an iframe preview overlay
        previewLinks: true,
        // Transition style
        transition: 'fade', // none/fade/slide/convex/concave/zoom
        // Transition speed
        transitionSpeed: 'default', // default/fast/slow
        // Transition style for full page slide backgrounds
        backgroundTransition: 'default', // none/fade/slide/convex/concave/zoom
        // Number of slides away from the current that are visible
        viewDistance: 3,



        // Optional reveal.js plugins
        dependencies: [
        ]
      });
    </script>
  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

<script>
  (function() {
    if (window.jQuery) {
      Reveal.addEventListener( 'slidechanged', function(event) {  
        window.jQuery(event.previousSlide).trigger('hidden');
        window.jQuery(event.currentSlide).trigger('shown');
      });
    }
  })();
</script>


  </body>
</html>
